<!DOCTYPE html>

<link rel="import" href="/base/base.html">
<link rel="import" href="/model/card.html">
<link rel="import" href="/model/card_stack.html">
<link rel="import" href="/model/config.html">
<link rel="import" href="/model/player.html">

<script>

mm.exportTo('mm.m', function() {

  var Card = mm.m.Card;
  var CardStack= mm.m.CardStack;
  var Player = mm.m.Player;

  function Model(numPlayers) {
    var tempStack = new CardStack();
    mm.m.AddInitialCards(tempStack);
    tempStack.shuffle();

    this.stacks_ = [new CardStack(), new CardStack()];
    tempStack.distribute(this.stacks_);

    this.players_ = []
    for (var i = 0; i < numPlayers; ++i) {
      this.players_.push(new Player());
    }
  }

  Model.prototype = {
    format: function(prefix) {
      var output = '';
      for (var i = 0; i < this.stacks_.length; ++i) {      
        output += prefix + 'Stack ' + i + ':\n';
        output += this.stacks_[i].format(prefix + '  ');
      }
      for (var i = 0; i < this.players_.length; ++i) {
        output += prefix + 'Player ' + i + ':\n';
        output += this.players_[i].format(prefix + '  ');
      }
      return output;
    }
  };

  return {
    Model: Model
  };
});

</script>
